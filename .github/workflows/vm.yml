name: ZUNRDP_VM_SYSTEM
on: 
  workflow_dispatch:
    inputs:
      vmid:
        description: 'VM ID'
        required: true
      owner:
        description: 'Owner Name'
        required: true

jobs:
  deploy: # Đổi tên job thành deploy cho giống ảnh 14736
    runs-on: windows-latest
    steps:
      - name: Preparing User
        run: |
          # Ép tạo User ngay từ đầu để tránh lỗi "did not work"
          net user ZunRdp ZunRdp@2026@Cloud /add /y
          net localgroup Administrators ZunRdp /add
          
      - name: Setting up ZunRdp
        run: |
          Invoke-WebRequest -Uri "https://raw.githubusercontent.com/${{ github.repository }}/main/zunrdp.ps1" -OutFile "zunrdp.ps1"
          powershell -ExecutionPolicy Bypass -File "zunrdp.ps1" -OWNER_NAME "${{ github.event.inputs.owner }}"
          
